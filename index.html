<!doctype html>
<html class="no-js" lang="en">

<head>
  <!--

     _           _   _        __  __       _   _          ______
    / \         | | (_)      |  \/  |     | | | |        |  ____|
   / _ \   _ __ | |_ _ ______| \  / | __ _| |_| |_ ______| |__   _ __
  / /_\ \ | '_ \| __| |______| |\/| |/ _` | __| __|______|  __| | '__|
 / /(_)\ \| | | | |_| |      | |  | | (_| | |_| |_       | |____| |
/_/     \_\_| |_|\__|_|      |_|  |_|\__,_|\__|\__|      |______|_|

  -->
  <meta charset="utf-8">
  <title>Anti-Matt-Er, a creative enthusiast | Portfolio</title>
  <meta name="description"
    content="A creative enthusiast producing custom-made quality branding, print, web design. Illustrator & Photoshop experience: vector, photo touch-ups, background removal">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link rel="manifest" href="site.webmanifest">
  <link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
  <link rel="icon" href="favicon.ico" type="image/x-icon">
  <link rel="manifest" href="site.webmanifest">
  <link rel="mask-icon" href="safari-pinned-tab.svg" color="#F54838">
  <meta name="msapplication-TileColor" content="#00aba9">

  <link
    href="https://fonts.googleapis.com/css2?family=Josefin+Sans:wght@200;300;400&family=Jost:wght@300;400&family=Rajdhani:wght@600&display=swap"
    rel="stylesheet">
  <link rel="stylesheet" href="css/normalize.css">
  <link rel="stylesheet" href="css/main.css">
  <link rel="stylesheet" href="css/theme.css?doit2">

  <script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>
  <script src="https://pixijs.download/v7.0.3/pixi.min.js"></script>
  <meta name="theme-color" content="#F54838">
</head>

<body>
  <div class="window">
    <section id="intro-window" class="expand">
      <model-viewer src="img/portrait/model.glb" class="portrait" alt="Voxel selfie" loading="eager"
        shadow-intensity="2" camera-orbit="0deg 90deg 100%" camera-target="auto auto -0.35m">
      </model-viewer>
    </section>
    <section id="game-window" class="expand">
      <div class="game-header">
        <div class="game-score">SCORE: <span class="game-score-value">0</span></div>
        <div class="game-health">
          <div class="game-health-value"></div>
        </div>
      </div>
      <div class="game-container"></div>
      <div class="game-overlay">
        <button class="game-start game-play-button" onclick="startGame();">Play</button>
        <div class="game-over hidden">
          <span class="game-over-message">GAME OVER!</span>
          <div class="game-score-container">
            <span class="game-over-score">Score: <span class="game-score-value">0</span></span>
            <span class="game-hi-score">High Score: <span class="game-hi-score-value">0</span></span>
          </div>
          <button class="game-play-button" onclick="startGame();">Play Again</button>
        </div>
      </div>
    </section>
    <section id="print-window" class="expand">
      <model-viewer src="img/mirabeau.glb" class="booklet" alt="Mirabeau Bridge Album Booklet" loading="eager"
        animation-name="Open1" animation-crossfade-duration="0" shadow-intensity="2" camera-orbit="0deg 90deg 100%"
        max-camera-orbit="auto auto auto">
    </section>
    <section id="branding-window" class="expand">
      <div class="branding-top">
        <img src="img/logos/spacer.png" class="spacer-logo" alt="Spacer logo" />
        <img src="img/logos/frenchhistorysociety.svg" alt="The Society for the Study of French History logo"
          role="img" />
      </div>
      <div class="branding-hero">
        <img src="img/logos/antimatter.svg" alt="Anti-Matt-Er logo" role="img" />
      </div>
      <div class="branding-bottom">
        <img src="img/logos/atz.svg" alt="After The Zenith logo" role="img" />
        <img src="img/logos/bumpercrop.png" alt="Bumper Crop logo" />
      </div>
    </section>
    <section id="music-window" class="expand">
      <div class="music-album-art">
        <div><img src="img/albumart/rendezvous.jpg" alt="Album Art for Rendezvous" /></div>
        <div><img src="img/albumart/behindthesun.jpg" alt="Album Art for Behind the Sun" /></div>
        <div><img src="img/albumart/somarain.jpg" alt="Album Art for Soma Rain" /></div>
        <div><img src="img/albumart/behindglass.jpg" alt="Album Art for Behind Glass" /></div>
      </div>
      <div class="music-seeker">
        <div class="music-seeker-bar">
          <div class="music-seeker-bar-bg"></div>
          <div class="music-seeker-progress">
            <div class="music-seeker-handle"></div>
          </div>
        </div>
        <div class="music-seeker-times">
          <div class="music-seeker-timestamp">0:00</div>
          <div class="music-seeker-duration">0:00</div>
        </div>
      </div>
      <div class="music-track-info">
        <div>
          <div class="music-artist-name">After The Zenith</div>
          <div class="music-song-name">Rendezvous</div>
        </div>
        <div>
          <div class="music-artist-name">After The Zenith</div>
          <div class="music-song-name">Behind the Sun</div>
        </div>
        <div>
          <div class="music-artist-name">After The Zenith</div>
          <div class="music-song-name">Soma Rain</div>
        </div>
        <div>
          <div class="music-artist-name">After The Zenith</div>
          <div class="music-song-name">Behind Glass</div>
        </div>
      </div>
      <div class="music-interface">
        <button class="music-previous-button icon-button">
          <img src="img/icons/previous.svg" class="icon-default" alt="Previous track icon" role="img">
          <img src="img/icons/previous-hover.svg" class="icon-hover" alt="Previous track icon" role="img">
        </button>
        <button class="music-play-button icon-button">
          <span class="paused">
            <img src="img/icons/play.svg" class="icon-default" alt="Play track icon" role="img">
            <img src="img/icons/play-hover.svg" class="icon-hover" alt="Play track icon" role="img">
          </span>
          <span class="playing hidden">
            <img src="img/icons/pause.svg" class="icon-default" alt="Pause track icon" role="img">
            <img src="img/icons/pause-hover.svg" class="icon-hover" alt="Pause track icon" role="img">
          </span>
        </button>
        <button class="music-next-button icon-button">
          <img src="img/icons/next.svg" class="icon-default" alt="Next track icon" role="img">
          <img src="img/icons/next-hover.svg" class="icon-hover" alt="Next track icon" role="img">
        </button>
      </div>
    </section>
    <div class="window-overlay">
      <button class="toggle-expand icon-button" onclick="toggleExpand();">
        <span class="expand">
          <img src="img/icons/expand.svg" class="icon-default" alt="Expand window icon" role="img">
          <img src="img/icons/expand-hover.svg" class="icon-hover" alt="Expand window icon" role="img">
        </span>
        <span class="restore">
          <img src="img/icons/restore.svg" class="icon-default" alt="Restore window icon" role="img">
          <img src="img/icons/restore-hover.svg" class="icon-hover" alt="Restore window icon" role="img">
        </span>
      </button>
    </div>
  </div>
  <div class="shadow shadow1"></div>
  <div class="shadow shadow2"></div>
  <div class="shadow shadow3"></div>
  <div class="main">
    <header>
      <div class="header-content">
        <div class="header-left">
          <button class="contact-button"><span>Hire me!</span></button>
        </div>
        <img src="img/logo.svg" class="logo" alt="Anti-Matt-Er logo" role="img" />
        <div class="header-right">
          <button class="toggle-expand-content icon-button" onclick="toggleExpandContent(true);">
            <span class="expand">
              <img src="img/icons/expand-dark.svg" class="icon-default" alt="Expand content icon" role="img">
              <img src="img/icons/expand-hover.svg" class="icon-hover" alt="Expand content icon" role="img">
            </span>
            <span class="restore">
              <img src="img/icons/restore-dark.svg" class="icon-default" alt="Restore content icon" role="img">
              <img src="img/icons/restore-hover.svg" class="icon-hover" alt="Restore content icon" role="img">
            </span>
          </button>
        </div>
      </div>
    </header>
    <main>
      <section id="intro" tabindex="0">
        <h1 class="section-anchor">A Digital Creative Enthusiast</h1>
        <p>Hi! I'm Matt from Lancaster, UK. I make things!</p>
        <p>This is a hand-crafted portfolio of some examples of my professional work and other creative endeavours.
        </p>
        <p>The first item I would bring to your attention is the website itself: a bespoke design made with custom
          html,
          css and javascript.</p>
        <p>Look below for a selection of examples of my professional work and other labours of love.</p>
      </section>
      <section id="game" tabindex="0">
        <h1 class="section-anchor">Game Design, Development &amp; Game-Ready Assets</h1>
        <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore
          magna aliqua. Tempus urna et pharetra pharetra massa massa ultricies mi. Placerat in egestas erat imperdiet
          sed euismod nisi. A pellentesque sit amet porttitor eget dolor. Cras pulvinar mattis nunc sed blandit libero
          volutpat sed. Id eu nisl nunc mi. Malesuada proin libero nunc consequat. Potenti nullam ac tortor vitae purus
          faucibus. Pellentesque eu tincidunt tortor aliquam nulla facilisi cras fermentum. Venenatis tellus in metus
          vulputate eu scelerisque felis imperdiet. Felis imperdiet proin fermentum leo vel orci porta non. Viverra
          mauris in aliquam sem fringilla ut. Hac habitasse platea dictumst quisque sagittis purus sit amet volutpat.
          Euismod quis viverra nibh cras pulvinar mattis.</p>
      </section>
      <section id="print" tabindex="0">
        <h1 class="section-anchor">High-Quality Print Media</h1>
        <p>Elementum integer enim neque volutpat ac. Mattis aliquam faucibus purus in massa tempor nec feugiat nisl.
          Imperdiet nulla malesuada pellentesque elit eget gravida cum sociis. A lacus vestibulum sed arcu non. Diam
          quam nulla porttitor massa id neque aliquam vestibulum morbi. Interdum posuere lorem ipsum dolor sit amet.
          Aliquam purus sit amet luctus venenatis lectus. Sit amet facilisis magna etiam tempor orci eu. Rhoncus urna
          neque viverra justo nec ultrices dui sapien. Ullamcorper velit sed ullamcorper morbi tincidunt. Non tellus
          orci ac auctor augue mauris augue neque gravida. Consectetur adipiscing elit duis tristique sollicitudin nibh
          sit. Eget nulla facilisi etiam dignissim diam quis. Quis enim lobortis scelerisque fermentum dui faucibus in
          ornare quam. Purus faucibus ornare suspendisse sed. Tincidunt arcu non sodales neque sodales.</p>
      </section>
      <section id="branding" tabindex="0">
        <h1 class="section-anchor">Eyecatching Branding &amp; Logos</h1>
        <p>Quis enim lobortis scelerisque fermentum dui faucibus in. Consectetur adipiscing elit duis tristique
          sollicitudin. Massa massa ultricies mi quis hendrerit dolor. Odio pellentesque diam volutpat commodo sed
          egestas egestas. In cursus turpis massa tincidunt. Nunc mattis enim ut tellus elementum. Velit scelerisque in
          dictum non consectetur a erat nam. Sed vulputate odio ut enim blandit volutpat maecenas volutpat. Nunc sed
          velit dignissim sodales ut eu sem. Vel facilisis volutpat est velit egestas dui. Nunc mi ipsum faucibus vitae
          aliquet nec ullamcorper sit. Arcu risus quis varius quam quisque id diam vel quam. Ac turpis egestas maecenas
          pharetra convallis posuere morbi leo. Nec feugiat in fermentum posuere urna nec tincidunt.</p>
      </section>
      <section id="music" class="last-section" tabindex="0">
        <h1 class="section-anchor">Music You Can't Get Enough Of</h1>
        <p>Vitae tortor condimentum lacinia quis vel eros donec ac odio. Tellus integer feugiat scelerisque varius morbi
          enim nunc faucibus a. Tempus iaculis urna id volutpat lacus. Accumsan lacus vel facilisis volutpat est velit
          egestas dui. Euismod elementum nisi quis eleifend quam adipiscing vitae. Facilisi cras fermentum odio eu
          feugiat pretium. Odio tempor orci dapibus ultrices in iaculis nunc sed. In nulla posuere sollicitudin aliquam
          ultrices sagittis orci. Id interdum velit laoreet id donec ultrices tincidunt. Orci eu lobortis elementum nibh
          tellus. Tortor posuere ac ut consequat. Eu lobortis elementum nibh tellus molestie nunc non blandit massa.</p>
      </section>
      <section id="contact">
        <div class="contact-form">
          <form action="https://formspree.io/xqkzlbky" method="POST" target="_blank">
            <h1 class="section-anchor">Get a quote...</h1>
            <label>
              What should I call you?
              <input type="text" name="name" required autocomplete="name">
            </label>
            <label>
              What's your email?
              <input type="text" name="_replyto" required autocomplete="email">
            </label>
            <label>
              Tell me about your project!
              <textarea name="message" required></textarea>
            </label>
            <button type="submit"><span>Submit</span></button>
          </form>
          <aside>
            <h1>Or say hi!</h1>
            <div class="contact-message">
              Don't hesitate to get in touch by email, or use one of the socials below!
            </div>
            <div class="contact-email-container">
              <img src="img/icons/mail.svg" alt="Email icon" class="contact-email-icon" role="img">
              <a class="contact-email">Please enable Javascript to see my email address, or use the contact form
                instead</a>
            </div>
            <div class="contact-zocials">
              <button class="zocial-button">
                <img src="img/icons/zocial/twitter.svg" class="icon-default" alt="Twitter icon" role="img">
              </button>
              <button class="zocial-button">
                <img src="img/icons/zocial/discord.svg" class="icon-default" alt="Discord icon" role="img">
              </button>
              <button class="zocial-button">
                <img src="img/icons/zocial/reddit.svg" class="icon-default" alt="Reddit icon" role="img">
              </button>
              <button class="zocial-button">
                <img src="img/icons/zocial/youtube.svg" class="icon-default" alt="YouTube icon" role="img">
              </button>
            </div>
          </aside>
        </div>
      </section>
    </main>
    <footer>
      <nav class="section-nav">
        <a href="#intro" title="About Me">
          <img src="img/icons/about.svg" alt="Waving hand icon" role="img">
          <span>About Me</span>
        </a>
        <a href="#game" title="Game Dev">
          <img src="img/icons/games.svg" alt="Joystick icon" role="img">
          <span>Game Dev</span>
        </a>
        <a href="#print" title="Print">
          <img src="img/icons/print.svg" alt="Print media icon" role="img">
          <span>Print</span>
        </a>
        <a href="#branding" title="Branding">
          <img src="img/icons/branding.svg" alt="Brand logo icon" role="img">
          <span>Branding</span>
        </a>
        <a href="#music" title="Music">
          <img src="img/icons/music.svg" alt="Record with music note icon" role="img">
          <span>Music</span>
        </a>
      </nav>
    </footer>
  </div>
  <script src="js/vendor/modernizr-3.7.1.min.js"></script>
  <script src="js/plugins.js"></script>
  <script src="js/game.js"></script>
  <script>
    const defaultPortraitYaw = 0;
    const defaultPortraitPitch = 85.0;
    const maxPortraitRot = 20.0;
    const portraitTiltStrength = 100;
    const main = document.querySelector("main");
    const hero = document.querySelector(".window");
    const content = document.querySelector(".main");
    const shadows = document.querySelectorAll(".shadow");
    const footer = document.querySelector("footer");
    const sectionNav = document.querySelector(".section-nav");
    const portrait = document.querySelector(".portrait");
    const booklet = document.querySelector(".booklet");
    const expandButton = document.querySelector(".toggle-expand");
    const expandContentButton = document.querySelector(".toggle-expand-content");
    const mainSections = document.querySelectorAll("main>section");
    const windowSections = Array.from(document.querySelectorAll(".window>section")).reverse();
    const sectionAnchors = Array.from(document.querySelectorAll(".section-anchor")).reverse();
    const header = document.querySelector("header");
    const navButtons = document.querySelectorAll(".section-nav>a");
    const contactButtons = document.querySelectorAll(".contact-button");
    const emailLink = document.querySelector(".contact-email");
    const contentExpandCooldown = 1000;
    const musicPlayer = {
      trackCount: 4,
      tick: 100,
      play: document.querySelector(".music-play-button"),
      previous: document.querySelector(".music-previous-button"),
      next: document.querySelector(".music-next-button"),
      seeker: document.querySelector(".music-seeker-bar"),
      progress: document.querySelector(".music-seeker-progress"),
      timestamp: document.querySelector(".music-seeker-timestamp"),
      duration: document.querySelector(".music-seeker-duration"),
      covers: document.querySelectorAll(".music-album-art>div"),
      trackNames: document.querySelectorAll(".music-track-info>div"),
      playingIcon: document.querySelector(".music-play-button>.playing"),
      pausedIcon: document.querySelector(".music-play-button>.paused")
    };

    const mod = (n, m) => {
      return ((n % m) + m) % m;
    };

    let trackIndex = 0;
    let tracks = [
      {
        file: "rendezvous",
        audio: null,
        length: 0
      },
      {
        file: "behindthesun",
        audio: null,
        length: 0
      },
      {
        file: "somarain",
        audio: null,
        length: 0
      },
      {
        file: "behindglass",
        audio: null,
        length: 0
      }
    ];
    let musicTicker;
    let seek = 0;
    let loadedTracks = 0;
    let allTracksLoaded = false;
    let musicHandleGrabbed = false;
    let playing = false;

    tracks.forEach(track => {
      track.audio = new Audio("music/" + track.file + ".mp3");
      track.audio.addEventListener("loadeddata", () => {
        track.length = track.audio.duration;
        loadedTracks++;
        if (loadedTracks === musicPlayer.trackCount) {
          allTracksLoaded = true;
          updateSeeker();
        }
      });
      track.audio.addEventListener("ended", () => {
        chooseTrack(1);
      });
    });

    const chooseTrack = (trackOffset) => {
      if (!allTracksLoaded) return;
      if (playing) {
        tracks[trackIndex].audio.pause();
      }
      trackIndex = mod(trackIndex + trackOffset, musicPlayer.trackCount);
      seek = 0;
      tracks[trackIndex].audio.currentTime = 0;
      if (playing) {
        tracks[trackIndex].audio.play();
      }
      updateSeeker();
      updateTicker();
      for (let i = 0; i < musicPlayer.trackCount; i++) {
        let offset = (trackIndex * 100).toString() + "%";
        musicPlayer.covers[i].style["margin-left"] = "-" + offset;
        musicPlayer.covers[i].style["margin-right"] = offset;
        musicPlayer.trackNames[i].style["margin-left"] = "-" + offset;
        musicPlayer.trackNames[i].style["margin-right"] = offset;
      }
    };

    const secondsToMinutesString = (seconds) => {
      let minutes = Math.floor(seconds / 60.0);
      seconds = mod(seconds, 60);
      return minutes.toString() + ":" + (new Array(3).join("0") + Math.floor(seconds).toString()).slice(-2);
    };

    const updateSeeker = () => {
      if (!tracks[trackIndex].length) return;
      musicPlayer.progress.style.width = (seek * 100).toString() + "%";
      musicPlayer.timestamp.innerHTML = secondsToMinutesString(tracks[trackIndex].length * seek);
      musicPlayer.duration.innerHTML = secondsToMinutesString(tracks[trackIndex].length);
    };

    const updateTicker = () => {
      if (playing) {
        musicTicker = setInterval(() => {
          if (!musicHandleGrabbed) {
            seek = tracks[trackIndex].audio.currentTime / tracks[trackIndex].length;
            updateSeeker();
          }
        }, musicPlayer.tick);
      } else if (musicTicker !== undefined) {
        clearInterval(musicTicker);
      }
    };

    const seekToX = (x) => {
      seek = (x - musicPlayer.seeker.offsetLeft) / musicPlayer.seeker.clientWidth;
      seek = Math.max(0, Math.min(seek, 1));
      updateSeeker();
      updateTicker();
    }

    musicPlayer.next.addEventListener("click", () => {
      chooseTrack(1);
    });

    musicPlayer.previous.addEventListener("click", () => {
      chooseTrack(-1);
    });

    musicPlayer.play.addEventListener("click", () => {
      if (!allTracksLoaded) return;
      if (playing) {
        tracks[trackIndex].audio.pause();
        musicPlayer.playingIcon.classList.add("hidden");
        musicPlayer.pausedIcon.classList.remove("hidden");
      }
      else {
        tracks[trackIndex].audio.play();
        musicPlayer.playingIcon.classList.remove("hidden");
        musicPlayer.pausedIcon.classList.add("hidden");
      }
      playing = !playing;
      updateTicker();
    });

    musicPlayer.seeker.addEventListener("pointerdown", (e) => {
      if (!allTracksLoaded) return;
      musicHandleGrabbed = true;
      seekToX(e.x);
    });

    addEventListener("pointerup", () => {
      if (!musicHandleGrabbed) return;
      musicHandleGrabbed = false;
      tracks[trackIndex].audio.currentTime = tracks[trackIndex].length * seek;
      updateTicker();
    });

    addEventListener("pointermove", (e) => {
      if (!musicHandleGrabbed) return;
      seekToX(e.x);
    });

    const bookletAnimations = [
      'Open1',
      'Open2',
      'Open3',
      'Open4',
      'Open5',
      'Open6',
      'Open7',
      'Open8',
      'Open9',
      'Open10',
      'Open11',
      'Close',
      'Flip'
    ];
    const bookletFlipDuration = 1.25;
    let bookletIndex = bookletAnimations.length - 1;

    let sections = [];
    let expanded = false;
    let contentExpanded = false;
    let userContentExpanded = false;
    let disableContentExpand = false;
    let currentSection = sections[0];
    let lastSection = sectionAnchors.length - 1;

    const toggleExpand = () => {
      if (expanded) {
        document.body.classList.remove("expand");
        hero.classList.remove("expand");
        content.classList.remove("shrink");
        expandButton.classList.remove("expand");
        footer.classList.remove("expand");
        sectionNav.classList.remove("expand");
        shadows.forEach(shadow => {
          shadow.classList.remove("shrink");
        });
      } else {
        document.body.classList.add("expand");
        hero.classList.add("expand");
        content.classList.add("shrink");
        expandButton.classList.add("expand");
        footer.classList.add("expand");
        sectionNav.classList.add("expand");
        shadows.forEach(shadow => {
          shadow.classList.add("shrink");
        });
      }
      expanded = !expanded;
    };

    const toggleExpandContent = (user = false) => {
      if (disableContentExpand) return;
      disableContentExpand = true;
      if (expanded) {
        toggleExpand();
      }
      if (contentExpanded) {
        expandButton.classList.remove("hidden");
        expandContentButton.classList.remove("expand");
        hero.style.height = "";
      } else {
        expandButton.classList.add("hidden");
        expandContentButton.classList.add("expand");
        hero.style.height = 0;
      }
      contentExpanded = !contentExpanded;
      userContentExpanded = user && contentExpanded;
      setTimeout(() => {
        disableContentExpand = false;
        if (!user) syncScroll();
      }, contentExpandCooldown);
    };

    let interaction = {
      x: 0,
      y: 0
    }

    const tiltPortrait = () => {
      let height = document.documentElement.clientHeight;
      let width = document.documentElement.clientWidth;
      let center_x = portrait.clientWidth / 2.0;
      let center_y = height / 2.0;
      let yaw = -(interaction.x - center_x) / width * maxPortraitRot + defaultPortraitYaw;
      let pitch = -(interaction.y - center_y) / height * maxPortraitRot + defaultPortraitPitch;
      let orbit = yaw.toString() + "deg " + pitch.toString() + "deg 110%";
      portrait.cameraOrbit = orbit;
      booklet.cameraOrbit = orbit;
    };

    let bookFlipBackwards = false;
    let bookFlipOffset = 0;
    let bookCanFlip = true;
    const queueNextBookletAnimation = () => {
      bookletDirection = bookFlipBackwards ? -1 : 1;
      bookletIndex = mod(bookletIndex + bookletDirection + bookFlipOffset, bookletAnimations.length);
      if (bookFlipBackwards) {
        booklet.animationName = bookletAnimations[bookletIndex] + "R";
      } else {
        booklet.animationName = bookletAnimations[bookletIndex];
      }
      booklet.currentTime = 0;
    }

    const flipBooklet = (backwards = false) => {
      if (!bookCanFlip) return;
      bookCanFlip = false;
      if (bookFlipBackwards && !backwards) {
        bookFlipOffset = -1;
      } else if (!bookFlipBackwards && backwards) {
        bookFlipOffset = 1;
      } else {
        bookFlipOffset = 0;
      }
      bookFlipBackwards = backwards;
      queueNextBookletAnimation();
      booklet.play();
    }

    booklet.addEventListener("click", (e) => {
      flipBooklet(e.clientX < booklet.clientWidth / 2.0);
    });

    booklet.addEventListener("play", (e) => {
      setTimeout(() => {
        booklet.pause();
        booklet.currentTime = bookletFlipDuration;
        bookCanFlip = true;
      }, bookletFlipDuration * 1000);
    });

    window.addEventListener("mousemove", (e) => {
      interaction.x = e.pageX;
      interaction.y = e.pageY;
      tiltPortrait();
    });

    window.addEventListener("devicemotion", (e) => {
      interaction.x = e.accelerationIncludingGravity.x * portraitTiltStrength;
      interaction.y = e.accelerationIncludingGravity.y * portraitTiltStrength;
      tiltPortrait();
    });

    const scrollToSection = (sectionIndex) => {
      currentSection = sections[sectionIndex];
      history.pushState(currentSection, "", currentSection);
      for (const section of windowSections) {
        let offset = (sectionIndex * 100).toString() + "%";
        section.style["margin-left"] = "-" + offset;
        section.style["margin-right"] = offset;
      }
    };

    const anchorScrollToSection = (sectionIndex) => {
      currentSection = sections[sectionIndex];
      history.pushState(currentSection, "", currentSection);
      if (expanded) {
        scrollToSection(sectionIndex);
        return;
      }
      mainSections[sectionIndex].scrollIntoView({
        behavior: "smooth"
      });
    };

    const registerScrollButton = (button, sectionIndex) => {
      button.addEventListener("click", (e) => {
        e.preventDefault();
        anchorScrollToSection(sectionIndex);
        if (expanded) {
          location.hash = currentSection;
        }
      });
    };

    const syncScroll = () => {
      if (expanded) return;
      let sectionIndex = lastSection;
      for (const anchor of sectionAnchors) {
        if (main.scrollTop + main.clientHeight > anchor.offsetTop) {
          if (sectionIndex === lastSection) {
            if (!userContentExpanded && !contentExpanded && window.innerHeight >= window.innerWidth) {
              toggleExpandContent();
            }
            break;
          } else if (!userContentExpanded && contentExpanded && window.innerHeight >= window.innerWidth) {
            toggleExpandContent();
          }
          scrollToSection(sectionIndex);
          break;
        }
        sectionIndex--;
      }
    };

    main.addEventListener("scroll", (e) => syncScroll());

    addEventListener("resize", (e) => {
      if (contentExpanded && window.innerHeight < window.innerWidth) {
        toggleExpandContent();
      }
      syncScroll();
    });

    expandButton.addEventListener("click", () => toggleExpand);

    let sectionIndex = 0;
    for (const button of navButtons) {
      sections.push(button.getAttribute("href"));
      registerScrollButton(button, sectionIndex);
      sectionIndex++;
    };
    for (const button of contactButtons) {
      registerScrollButton(button, sectionIndex);
    }

    const mailDecrypter = (piece) => {
      return
    };
    const encryptedMail = "7662756975726c727340656f6d2e2e6b77632e6f";
    const mailKey = "msbehflqijgdakortncp";
    let decryptedMail = "";
    for (const char of mailKey) {
      let i = 2 * (char.charCodeAt(0) - 97);
      decryptedMail += String.fromCharCode(Number("0x" + encryptedMail[i] + encryptedMail[i + 1]));
    }
    emailLink.innerHTML = decryptedMail;
    emailLink.setAttribute("href", "mailto:" + decryptedMail);
  </script>
</body>

</html>